<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.maint.maintain.mapper.IDbMaintainMapper"><!-- 根据站点编号查询该站点的维护情况 -->	<select id="findMaintainBySiteId" parameterType="java.util.Map" resultType="DbMaintain">		select *		from 		db_maintain m		left join db_siteinformation s on m.sitemainId=s.siteId		<where>		<if test="siteid !=null and siteid!=''">			and m.sitemainId='${siteid}'		</if>		</where>	</select>				<insert id="insertMaintain"		parameterType="DbMaintain">		insert into db_maintain		(sitemainId,maintainId,maintainName,faultDate,faultTypeId,faultTypeName,dtusupplierId,dtusupplierName,rtusupplierId,rtusupplierName,faultContent,faultUserId,faultUserName,resolvent,maintainImg,maintainImgs,maintainManId,maintainMan,maintainDate,faultother,card,remark)values(#{sitemainId},#{maintainId},#{maintainName},#{faultDate},#{faultTypeId},#{faultTypeName},#{dtusupplierId},#{dtusupplierName},#{rtusupplierId},#{rtusupplierName},#{faultContent},#{faultUserId},#{faultUserName},#{resolvent},#{maintainImg},#{maintainImgs},#{maintainManId},#{maintainMan},GETDATE(),#{faultother},#{card},#{remark})	</insert>		<insert id="addFault">	insert into db_maintain(sitemainId,faultContent,faultDate,faultUserId,faultUserName)		values(#{sitemainId},#{faultContent},GETDATE(),#{faultUserId},#{faultUserName})		</insert>		<delete id="delMaintain">			delete from db_maintain where id=#{id}	</delete>			<!-- 新增维护日志 -->	<insert id="addMainLog" parameterType="DbMainLog">		insert into db_mainlog		(sitemainId,sitemainName,resolvent,maintainDate,remark,maintainManId,maintainManName)		values(#{sitemainId},#{sitemainName},#{resolvent},#{maintainDate},#{remark},#{maintainManId},#{maintainManName})			</insert>		<!-- 统计当天的维护情况 -->	<select id="findDay" resultType="DbMaintain">				 select * from db_maintain where DateDiff(dd,maintainDate,getdate())=0		</select>			<select id="findDayLog" resultType="DbMainLog">				select * from db_mainlog where DateDiff(dd,maintainDate,getdate())=0		</select>		<select id="findDayByDate" resultType="DbMainLog">		 select * from db_mainlog where maintainDate <![CDATA[ >= ]]> #{startDate} and maintainDate <![CDATA[ <= ]]> #{endDate}	</select>		<select id="MainfindByid" resultType="DbMaintain">		select * from db_maintain where id=#{id}	</select>		<select id="findDayBySiteId" resultType="java.lang.Integer">		select COUNT(*) from db_mainlog where DateDiff(dd,maintainDate,getdate())=0 and sitemainId=#{siteId}			</select>	
</mapper> 